# dbbackup Production Inventory
# Ansible l√§uft auf dev.uuxo.net - direkter SSH-Zugang zu allen Hosts

all:
  vars:
    ansible_user: root
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null'
    dbbackup_version: "5.7.2"
    # Binary wird von dev.uuxo.net aus deployed (dort liegt es in /tmp nach scp)
    dbbackup_binary_src: "/tmp/dbbackup_linux_amd64"

  children:
    db_servers:
      hosts:
        mysql01.uuxoi.local:
          dbbackup_db_type: mariadb
          dbbackup_databases: 
            - ejabberd
          dbbackup_backup_dir: /mnt/smb-mysql01/backups/databases
          dbbackup_socket: /var/run/mysqld/mysqld.sock
          dbbackup_pitr_enabled: true
          dbbackup_backup_script: backup-mysql01.sh

        alternate.uuxoi.local:
          dbbackup_db_type: mariadb
          dbbackup_databases:
            - dbispconfig
            - c1aps1
            - c2marianskronkorken
            - matomo
            - phpmyadmin
            - roundcube
            - roundcubemail
          dbbackup_backup_dir: /mnt/smb-alternate/backups/databases
          dbbackup_host: 127.0.0.1
          dbbackup_port: 3306
          dbbackup_password: "xt3kci28"
          dbbackup_backup_script: backup-alternate.sh

        cloud.uuxoi.local:
          dbbackup_db_type: mariadb
          dbbackup_databases:
            - nextcloud_db
          dbbackup_backup_dir: /mnt/smb-cloud/backups/dedup
          dbbackup_socket: /var/run/mysqld/mysqld.sock
          dbbackup_dedup_enabled: true
          dbbackup_backup_script: backup-cloud.sh

    # Hosts mit speziellen Anforderungen
    special_hosts:
      hosts:
        git.uuxoi.local:
          dbbackup_db_type: mariadb
          dbbackup_databases:
            - gitea
          dbbackup_note: "Docker-based MariaDB - needs SSH key setup"
