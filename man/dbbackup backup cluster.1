.nh
.TH "DBBACKUP" "1" "Feb 2026" "dbbackup" "Database Backup Tool"

.SH NAME
dbbackup-backup-cluster - Create full cluster backup (PostgreSQL only)


.SH SYNOPSIS
\fBdbbackup backup cluster [flags]\fP


.SH DESCRIPTION
Create a complete backup of the entire PostgreSQL cluster including all databases and global objects (roles, tablespaces, etc.).

.PP
Native Engine:
  --native           - Use pure Go native engine (SQL format, no pg_dump required)
  --fallback-tools   - Fall back to external tools if native engine fails

.PP
By default, cluster backup uses PostgreSQL custom format (.dump) for efficiency.
With --native, all databases are backed up in SQL format (.sql.gz) using the
native Go engine, eliminating the need for pg_dump.


.SH OPTIONS
\fB--auto\fP[=true]
	Auto-detect optimal settings based on system resources (default: true)

.PP
\fB--batch-size\fP=0
	Batch size for bulk operations (0 = auto-detect)

.PP
\fB--buffer-size\fP=0
	Buffer size in KB (0 = auto-detect)

.PP
\fB--cloud\fP=""
	Cloud storage URI (e.g., s3://bucket/path) - takes precedence over individual flags

.PP
\fB--cloud-auto-upload\fP[=false]
	Automatically upload backup to cloud after completion

.PP
\fB--cloud-bucket\fP=""
	Cloud bucket name

.PP
\fB--cloud-endpoint\fP=""
	Cloud endpoint (for MinIO/B2)

.PP
\fB--cloud-prefix\fP=""
	Cloud key prefix

.PP
\fB--cloud-provider\fP=""
	Cloud provider (s3, minio, b2)

.PP
\fB--cloud-region\fP="us-east-1"
	Cloud region

.PP
\fB--compression-algorithm\fP="gzip"
	Compression algorithm: gzip or zstd (zstd is 4-6x faster decompression)

.PP
\fB-n\fP, \fB--dry-run\fP[=false]
	Validate configuration without executing backup

.PP
\fB--dump-format\fP=""
	PostgreSQL dump format: custom (parallel restore, default), plain (SQL text), directory (parallel dump+restore)

.PP
\fB--encrypt\fP[=false]
	Encrypt backup with AES-256-GCM

.PP
\fB--encryption-key-env\fP="DBBACKUP_ENCRYPTION_KEY"
	Environment variable containing encryption key/passphrase

.PP
\fB--encryption-key-file\fP=""
	Path to encryption key file (32 bytes)

.PP
\fB--fallback-tools\fP[=false]
	Fall back to external tools if native engine fails

.PP
\fB--galera-desync\fP[=false]
	Enable Galera desync mode during backup (reduces cluster impact)

.PP
\fB--galera-health-check\fP[=true]
	Verify Galera node health before backup

.PP
\fB--galera-min-cluster-size\fP=2
	Minimum Galera cluster size required for backup

.PP
\fB--galera-prefer-node\fP=""
	Preferred Galera node name for backup (empty = current node)

.PP
\fB-h\fP, \fB--help\fP[=false]
	help for cluster

.PP
\fB--lo-vacuum\fP[=false]
	Clean up orphaned PostgreSQL large objects before backup (PG only)

.PP
\fB--lo-vacuum-timeout\fP=300
	Timeout in seconds for large object vacuum (default: 300)

.PP
\fB--mysql-batch-size\fP=5000
	Rows per extended INSERT in native engine (MySQL/MariaDB)

.PP
\fB--mysql-disable-keys\fP[=true]
	mysqldump --disable-keys: DISABLE KEYS around data load (MySQL/MariaDB)

.PP
\fB--mysql-extended-insert\fP[=true]
	mysqldump --extended-insert: multi-row INSERT (MySQL/MariaDB)

.PP
\fB--mysql-fast-restore\fP[=true]
	SET fk_checks=0, unique_checks=0 before restore (MySQL/MariaDB)

.PP
\fB--mysql-max-packet\fP="256M"
	max-allowed-packet for dump & restore (MySQL/MariaDB)

.PP
\fB--mysql-net-buffer-length\fP=1048576
	mysqldump --net-buffer-length in bytes (MySQL/MariaDB, max 1MB)

.PP
\fB--mysql-order-by-primary\fP[=false]
	mysqldump --order-by-primary: PK-sorted rows (MySQL/MariaDB)

.PP
\fB--mysql-quick\fP[=true]
	mysqldump --quick: row-by-row transfer, constant memory (MySQL/MariaDB)

.PP
\fB--native\fP[=false]
	Use pure Go native engine (SQL format, no external tools)

.PP
\fB--no-verify\fP[=false]
	Skip automatic backup verification after creation

.PP
\fB--pool-size\fP=0
	Connection pool size (0 = auto-detect)

.PP
\fB--verify-restore\fP[=false]
	After backup, restore into temp DB and compare row counts

.PP
\fB--workers\fP=0
	Number of parallel workers (0 = auto-detect)

.PP
\fB--xtrabackup\fP[=false]
	Use Percona XtraBackup / MariaBackup for physical hot backup

.PP
\fB--xtrabackup-compress\fP=""
	XtraBackup internal compression: quicklz, lz4, zstd (empty = no internal compression)

.PP
\fB--xtrabackup-compress-threads\fP=0
	Threads for xtrabackup internal compression

.PP
\fB--xtrabackup-encrypt\fP=""
	XtraBackup encryption: AES128, AES192, AES256

.PP
\fB--xtrabackup-encrypt-key-file\fP=""
	File containing encryption key for xtrabackup

.PP
\fB--xtrabackup-extra-args\fP=""
	Additional xtrabackup CLI arguments (space-separated)

.PP
\fB--xtrabackup-galera-info\fP[=false]
	Record Galera cluster position (--galera-info)

.PP
\fB--xtrabackup-incremental-basedir\fP=""
	Base directory for incremental xtrabackup

.PP
\fB--xtrabackup-incremental-lsn\fP=""
	LSN for incremental xtrabackup (instead of basedir)

.PP
\fB--xtrabackup-no-lock\fP[=false]
	Use --no-lock (InnoDB-only tables, skip FTWRL)

.PP
\fB--xtrabackup-parallel\fP=4
	Parallel copy threads for xtrabackup (--parallel)

.PP
\fB--xtrabackup-safe-slave\fP[=false]
	Wait for slave SQL thread to catch up (--safe-slave-backup)

.PP
\fB--xtrabackup-slave-info\fP[=false]
	Record slave replication coordinates (--slave-info)

.PP
\fB--xtrabackup-stream\fP=""
	Streaming format: xbstream or tar (empty = no streaming)

.PP
\fB--xtrabackup-throttle\fP=0
	Throttle IO operations per second (0 = unlimited)

.PP
\fB--xtrabackup-use-memory\fP="1G"
	Memory for xtrabackup --prepare (e.g., '1G', '512M')


.SH OPTIONS INHERITED FROM PARENT COMMANDS
\fB--allow-root\fP[=false]
	Allow running as root/Administrator

.PP
\fB--auto-detect-cores\fP[=true]
	Auto-detect CPU cores

.PP
\fB--backup-dir\fP="/root/db_backups"
	Backup directory

.PP
\fB--check-resources\fP[=true]
	Check system resource limits

.PP
\fB--compression\fP=6
	Compression level (0-9)

.PP
\fB-c\fP, \fB--config\fP=""
	Path to config file (default: .dbbackup.conf in current directory)

.PP
\fB--cpu-auto-tune\fP[=true]
	Vendor-aware auto-tuning (Intel/AMD/ARM parallelism, compression, buffer sizes)

.PP
\fB--cpu-boost\fP[=false]
	Set CPU governor to 'performance' during backup (requires root)

.PP
\fB--cpu-workload\fP="balanced"
	CPU workload type (cpu-intensive|io-intensive|balanced)

.PP
\fB--database\fP="postgres"
	Database name

.PP
\fB-d\fP, \fB--db-type\fP="postgres"
	Database type (postgres|mysql|mariadb)

.PP
\fB--debug\fP[=false]
	Enable debug logging

.PP
\fB--debug-locks\fP[=false]
	Enable detailed lock debugging (captures PostgreSQL lock configuration, Large DB Guard decisions, boost attempts)

.PP
\fB--dump-jobs\fP=8
	Number of parallel dump jobs

.PP
\fB--host\fP="localhost"
	Database host

.PP
\fB--insecure\fP[=false]
	Disable SSL (shortcut for --ssl-mode=disable)

.PP
\fB--jobs\fP=16
	Number of parallel jobs

.PP
\fB--max-cores\fP=32
	Maximum CPU cores to use

.PP
\fB--max-retries\fP=3
	Maximum connection retry attempts

.PP
\fB--min-backups\fP=5
	Minimum number of backups to keep

.PP
\fB--native-debug\fP[=false]
	Enable detailed native engine debugging

.PP
\fB--native-engine\fP[=true]
	Use pure Go native engines (alias for --native)

.PP
\fB--no-color\fP[=false]
	Disable colored output

.PP
\fB--no-config\fP[=false]
	Don't load configuration from .dbbackup.conf

.PP
\fB--no-save-config\fP[=false]
	Don't save configuration after successful operations

.PP
\fB--port\fP=5432
	Database port

.PP
\fB--retention-days\fP=30
	Backup retention period in days (0=disabled)

.PP
\fB--socket\fP=""
	Unix socket path for MySQL/MariaDB (e.g., /var/run/mysqld/mysqld.sock)

.PP
\fB--ssl-mode\fP="prefer"
	SSL mode for connections

.PP
\fB--user\fP="postgres"
	Database user


.SH SEE ALSO
\fBdbbackup-backup(1)\fP


.SH HISTORY
18-Feb-2026 Auto generated by spf13/cobra
