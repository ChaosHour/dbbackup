.nh
.TH "DBBACKUP" "1" "Feb 2026" "dbbackup" "Database Backup Tool"

.SH NAME
dbbackup-dedup - Deduplicated backup operations


.SH SYNOPSIS
\fBdbbackup dedup [flags]\fP


.SH DESCRIPTION
Content-defined chunking deduplication for space-efficient backups.

.PP
Similar to restic/borgbackup but with native database dump support.

.PP
Features:
- Content-defined chunking (CDC) with Buzhash rolling hash
- SHA-256 content-addressed storage
- AES-256-GCM encryption (optional)
- Gzip compression (optional)
- SQLite index for fast lookups

.PP
Storage Structure:
  /
    chunks/       # Content-addressed chunk files
      ab/cdef...  # Sharded by first 2 chars of hash
    manifests/    # JSON manifest per backup
    chunks.db     # SQLite index

.PP
NFS/CIFS NOTICE:
  SQLite may have locking issues on network storage.
  Use --index-db to put the SQLite index on local storage while keeping
  chunks on network storage:

.EX
dbbackup dedup backup mydb.sql \\
  --dedup-dir /mnt/nfs/backups/dedup \\
  --index-db /var/lib/dbbackup/dedup-index.db
.EE

.PP
This avoids "database is locked" errors while still storing chunks remotely.

.PP
COMPRESSED INPUT NOTICE:
  Pre-compressed files (.gz) have poor deduplication ratios (%).
  Use --decompress-input to decompress before chunking for better results:

.EX
dbbackup dedup backup mydb.sql.gz --decompress-input
.EE


.SH OPTIONS
\fB--compress\fP[=true]
	Compress chunks with gzip

.PP
\fB--dedup-dir\fP=""
	Dedup storage directory (default: $BACKUP_DIR/dedup)

.PP
\fB--encrypt\fP[=false]
	Encrypt chunks with AES-256-GCM

.PP
\fB-h\fP, \fB--help\fP[=false]
	help for dedup

.PP
\fB--index-db\fP=""
	SQLite index path (local recommended for NFS/CIFS chunk dirs)

.PP
\fB--key\fP=""
	Encryption key (hex) or use DBBACKUP_DEDUP_KEY env


.SH OPTIONS INHERITED FROM PARENT COMMANDS
\fB--allow-root\fP[=false]
	Allow running as root/Administrator

.PP
\fB--auto-detect-cores\fP[=true]
	Auto-detect CPU cores

.PP
\fB--backup-dir\fP="/root/db_backups"
	Backup directory

.PP
\fB--check-resources\fP[=true]
	Check system resource limits

.PP
\fB--compression\fP=6
	Compression level (0-9)

.PP
\fB-c\fP, \fB--config\fP=""
	Path to config file (default: .dbbackup.conf in current directory)

.PP
\fB--cpu-workload\fP="balanced"
	CPU workload type (cpu-intensive|io-intensive|balanced)

.PP
\fB--database\fP="postgres"
	Database name

.PP
\fB-d\fP, \fB--db-type\fP="postgres"
	Database type (postgres|mysql|mariadb)

.PP
\fB--debug\fP[=false]
	Enable debug logging

.PP
\fB--debug-locks\fP[=false]
	Enable detailed lock debugging (captures PostgreSQL lock configuration, Large DB Guard decisions, boost attempts)

.PP
\fB--dump-jobs\fP=8
	Number of parallel dump jobs

.PP
\fB--fallback-tools\fP[=true]
	Fallback to external tools if native engine fails

.PP
\fB--host\fP="localhost"
	Database host

.PP
\fB--insecure\fP[=false]
	Disable SSL (shortcut for --ssl-mode=disable)

.PP
\fB--jobs\fP=16
	Number of parallel jobs

.PP
\fB--max-cores\fP=32
	Maximum CPU cores to use

.PP
\fB--max-retries\fP=3
	Maximum connection retry attempts

.PP
\fB--min-backups\fP=5
	Minimum number of backups to keep

.PP
\fB--native\fP[=true]
	Use pure Go native engines (no external tools)

.PP
\fB--native-debug\fP[=false]
	Enable detailed native engine debugging

.PP
\fB--native-engine\fP[=true]
	Use pure Go native engines (alias for --native)

.PP
\fB--no-color\fP[=false]
	Disable colored output

.PP
\fB--no-config\fP[=false]
	Don't load configuration from .dbbackup.conf

.PP
\fB--no-save-config\fP[=false]
	Don't save configuration after successful operations

.PP
\fB--port\fP=5432
	Database port

.PP
\fB--retention-days\fP=30
	Backup retention period in days (0=disabled)

.PP
\fB--socket\fP=""
	Unix socket path for MySQL/MariaDB (e.g., /var/run/mysqld/mysqld.sock)

.PP
\fB--ssl-mode\fP="prefer"
	SSL mode for connections

.PP
\fB--user\fP="postgres"
	Database user


.SH SEE ALSO
\fBdbbackup(1)\fP, \fBdbbackup-dedup-backup(1)\fP, \fBdbbackup-dedup-backup-db(1)\fP, \fBdbbackup-dedup-delete(1)\fP, \fBdbbackup-dedup-gc(1)\fP, \fBdbbackup-dedup-list(1)\fP, \fBdbbackup-dedup-metrics(1)\fP, \fBdbbackup-dedup-prune(1)\fP, \fBdbbackup-dedup-restore(1)\fP, \fBdbbackup-dedup-stats(1)\fP, \fBdbbackup-dedup-verify(1)\fP


.SH HISTORY
16-Feb-2026 Auto generated by spf13/cobra
